version: '2'

services:

    logspout:
      container_name: "logspout"
      image: gliderlabs/logspout:v3
      command: 'syslog://logstash:5000'
      links:
        - logstash
      volumes:
        - '/var/run/docker.sock:/tmp/docker.sock'

    logstash:
      container_name: "logstash"
      image: ludekvesely/logstash-json
      environment:
        - LOGSPOUT=ignore
        - DROP_NON_JSON=false
        - STDOUT=true
      links:
        - elasticsearch
      networks:
        - elk

    kibana:
      container_name: "kibana"
      image: kibana
      environment:
        - LOGSPOUT=ignore
      links:
        - elasticsearch
      ports:
        - '5601:5601'
      networks:
        - elk

    elasticsearch:
      container_name: "elasticsearch"
      image: docker.elastic.co/elasticsearch/elasticsearch:5.3.0
      environment:
        - LOGSPOUT=ignore
      networks:
        - elk

networks:
  elk:
    driver: bridge
